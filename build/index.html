<div class="__abm_timer"
     data-redirect="/GB_seminar"
     data-days="yes"
     data-offset="-180"
     data-starts="
        0 0 21 * * * * |
        0 0 10-16 * * * * |
        0 0,30 17 * * * * |
        0 0 18,19,20 * * * *
     "
     data-interval="
        23 * 3600 |
        1 * 3600 |
        0.5 * 3600 |
        1 * 3600
     "
     data-target-offset="auto"
     data-duration="5 * 3600 * 24"
     data-caption1="С {d} {m} по {d2} {m2}"
     data-caption2="Марафон стартует ({d} {m} в {h}:{i} {ct})"
     data-caption3="Первое занятие марафона начнётся через:"
></div>

<<<<<<< HEAD
<!-- abm-timer version: 1.4.0 -->
=======
<!-- abm-timer version: 1.3.1 -->
>>>>>>> origin/master
<style>.__abm_timer{white-space:nowrap;text-align:center;font-family:Roboto,sans-serif}.__abm_timer_b1{display:inline-block;margin:0 22px;vertical-align:top}.__abm_timer_b1:first-child{margin-left:0}.__abm_timer_b1:last-child{margin-right:0}.__abm_timer_b2{position:relative;background-color:#f6f6f6;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;border:1px solid #e3e9f0;height:72px;line-height:70px;font-size:42px;text-align:center;font-weight:700;color:#fb0752;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:62px}.__abm_timer_b2::after,.__abm_timer_b2::before{position:absolute;content:'';width:6px;height:6px;background-color:#fb0752;left:100%;margin-left:20px;-webkit-animation:__abm_timer_dots 1s ease 0s infinite;-moz-animation:__abm_timer_dots 1s ease 0s infinite;-o-animation:__abm_timer_dots 1s ease 0s infinite;animation:__abm_timer_dots 1s ease 0s infinite}.__abm_timer_b2::before{top:22px}.__abm_timer_b2::after{bottom:22px}.__abm_timer_b1:last-child .__abm_timer_b2::after,.__abm_timer_b1:last-child .__abm_timer_b2::before{display:none}.__abm_timer_b3{text-align:center;font-family:_roboto_condensed,sans-serif;font-weight:700;color:#fb0752;font-size:12px;line-height:12px;text-transform:uppercase;margin-top:8px}.__abm_timer_b4{display:inline}.__abm_timer_b4:first-child{margin-left:0}.__abm_timer_b4:last-child{margin-right:0}@-webkit-keyframes __abm_timer_dots{0%{opacity:1}60%{opacity:1}80%{opacity:0}100%{opacity:1}}@-moz-keyframes __abm_timer_dots{0%{opacity:1}60%{opacity:1}80%{opacity:0}100%{opacity:1}}@-o-keyframes __abm_timer_dots{0%{opacity:1}60%{opacity:1}80%{opacity:0}100%{opacity:1}}@keyframes __abm_timer_dots{0%{opacity:1}60%{opacity:1}80%{opacity:0}100%{opacity:1}}.__abm_timer_b0{font-size:0}.__abm_timer_c0{color:#2b455d}.__abm_timer_c0 span{color:#fb0752}.__abm_timer_c1{font-size:22px;margin-bottom:10px;white-space:normal}.__abm_timer_c2{font-size:16px;white-space:normal}.__abm_timer_c3{font-size:16px;margin-bottom:10px;font-weight:700;white-space:normal}@media (max-width:767px){.__abm_timer_c3{font-size:14px}.__abm_timer_b1{margin:0 12px}.__abm_timer_b2::after,.__abm_timer_b2::before{margin-left:10px}}@media (max-width:479px){.__abm_timer_c3{font-size:14px}.__abm_timer_b1{margin:0 10px}.__abm_timer_b2{height:62px;line-height:60px;width:57px;font-size:34px}.__abm_timer_b2::after,.__abm_timer_b2::before{margin-left:8px;width:5px;height:5px}.__abm_timer_b2::before{top:18px}.__abm_timer_b2::after{bottom:18px}.__abm_timer_b3{font-size:10px;line-height:10px;margin-top:6px}}</style>
<script>(function(){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var API_URL="https://api.worldwideshop.ru/time/get/",CRON_SECONDS_ID=0,CRON_MINUTES_ID=1,CRON_HOURS_ID=2,CRON_DATES_ID=3,CRON_MONTHS_ID=4,CRON_DAYS_ID=5,CRON_YEARS_ID=6,timezones={},offsetMaps={},CRON_UNITS=[{min:0,max:59,default:"0"},{min:0,max:59,default:"0"},{min:0,max:23,default:"0"},{min:1,max:31,default:"*"},{min:1,max:12,default:"*",alt:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]},{min:0,max:6,default:"*",alt:["SUN","MON","TUE","WED","THU","FRI","SAT"],sundayFix:!0},{min:1970,max:2099,default:"*"}],getOffsetFromMap=function(t,e){var i=!1;try{if(offsetMaps[t])for(var a=offsetMaps[t],n=0;n<a.length;n++){var r=a[n],s=parseInt(r[0]);if(e<=(1<r.length?parseInt(r[1]):1/0)){i=s;break}}}catch(t){}return i},getIntlTimezone=function(){try{if(Intl){var t=Intl.DateTimeFormat();if(t){var e=t.resolvedOptions();if(e&&e.timeZone)return e.timeZone}}}catch(t){}return!1},getCityTime=function(){var t=getIntlTimezone(),e=timezones[t];return e&&e.cityTime||!1};window.getCityTime=getCityTime;var getTimezoneOffset=function(){return(new Date).getTimezoneOffset()},parseCronExpression=function(t){for(var p=function(t,e){for(var i=[],a=t;a<=e;a++)i.push(a);return i},e=function(i,a){for(var n=CRON_UNITS[a],t=i.split(","),e=function(t){var e=[n.min];try{e=function(t,e){var i=CRON_UNITS[e],a=t.split("/");if(2<a.length)throw new Error('Некорректное приращение "'.concat(t,'"'));var n="*"===a[0]?i.min+"-"+i.max:a[0],r=1<a.length?parseInt(a[1],10):null;if(null!==r&&(isNaN(r)||r<1))throw new Error('Некорректный коэффициент приращения "'.concat(a[1],'"'));var s={};if(i.alt)for(var o=0;o<i.alt.length;o++)s[i.alt[o]]=o+i.min;var l,f,c=function(t){var e=t;if(void 0!==s[t]&&(e=s[t]),e=parseInt(e,10),isNaN(e))throw new Error('Некорректное значение "'.concat(t,'"'));return e},u=null,h=null,_=n.split("-");if(0<_.length&&(u=c(_[0])),1===_.length)l=[u];else{if(2!==_.length)throw new Error('Некорректный диапазон "'.concat(n,'"'));if((h=c(_[1]))<u)throw new Error('Максимальное значение диапазона меньше, чем минимальное "'.concat(n,'"'));l=p(u,h)}if(null!==r&&(null===h&&(l=p(u,i.max)),l=l.filter(function(t){return(t-u)%r==0})),i.sundayFix){for(var d=l,m=[],T=0;T<d.length;T++)m.push(7===(f=d[T])?0:f);l=m}return l}(t,a)}catch(t){console.error('Ошибка парсинга "'.concat(i,'": ').concat(t.message))}return e},r=[],s=0;s<t.length;s++)r.push(e(t[s]));var o=r;o=[].concat.apply([],o);for(var l,f=[],c=o,u=0;u<c.length;u++)l=c[u],f.indexOf(l)<0&&f.push(l);var h=(o=(o=f).sort(function(t,e){return t-e}))[0],_=o[o.length-1],d=null;return h<n.min?d=h:_>n.max&&(d=_),null!==d&&console.error('Значение выходит за пределы возможных "'.concat(d,'" в "').concat(i,'"')),o},i=t.replace(/\s+/g," ").trim().split(" "),a=CRON_UNITS.length-1-i.length-1;0<=a;a--)i.unshift(CRON_UNITS[a].default);i.length===CRON_UNITS.length-1&&i.push(CRON_UNITS[CRON_YEARS_ID].default);for(var n,r=i,s=[],o=0;o<r.length;o++)s.push((n=r[o],e(n,o)));return s},cronLastRun=function(e,t){var a,i=new Date(t),n=function(){a=[i.getUTCSeconds(),i.getUTCMinutes(),i.getUTCHours(),i.getUTCDate(),i.getUTCMonth()+1,i.getUTCDay(),i.getUTCFullYear()]},r=function(t){return-1!==e[t].indexOf(a[t])},s=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;CRON_SECONDS_ID<=t&&i.setUTCSeconds(0),CRON_MINUTES_ID<=t&&i.setUTCMinutes(0),CRON_HOURS_ID<=t&&i.setUTCHours(0),CRON_DAYS_ID<=t&&i.setUTCDate(1),CRON_MONTHS_ID<=t&&i.setUTCMonth(0),i=new Date(i.getTime()-1e3),n()},o=function(){for(var t=a[CRON_YEARS_ID];t>=CRON_UNITS[CRON_YEARS_ID].min;t--)if(r(CRON_YEARS_ID))for(var e=a[CRON_MONTHS_ID];1<=e;e--)if(r(CRON_MONTHS_ID))for(var i=a[CRON_DATES_ID];1<=i;i--){if(r(CRON_DATES_ID)&&r(CRON_DAYS_ID))return!0;s(CRON_HOURS_ID)}else s(CRON_DAYS_ID);else s(CRON_MONTHS_ID);return!1},l=function(){for(var t=a[CRON_HOURS_ID];t>=CRON_UNITS[CRON_HOURS_ID].min;t--)if(r(CRON_HOURS_ID))for(var e=a[CRON_MINUTES_ID];e>=CRON_UNITS[CRON_MINUTES_ID].min;e--)if(r(CRON_MINUTES_ID))for(var i=a[CRON_SECONDS_ID];i>=CRON_UNITS[CRON_SECONDS_ID].min;i--){if(r(CRON_SECONDS_ID))return!0;s()}else s(CRON_SECONDS_ID);else s(CRON_MINUTES_ID);return!1};if(n(),!o())return!1;if(!l()){if(!o())return!1;l()}return t-i.getTime()},declOfNum=function(t,e){return e[4<t%100&&t%100<20?2:[2,0,1,1,1,2][t%10<5?t%10:5]]},newElement=function(t,e){var i=t.ownerDocument.createElement("div");return i.className=e,t.appendChild(i),i},assignToObject=function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var i=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(null!=i)for(var a in i)i.hasOwnProperty(a)&&(t[a]=i[a])}},formatText=function(t,e){var i={},a=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";i["d"+e]=t.getDate(),i["m"+e]=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"][t.getMonth()],i["h"+e]=("0"+t.getHours()).substr(-2),i["i"+e]=("0"+t.getMinutes()).substr(-2)};a(e.date),a(new Date(e.date.getTime()+1e3*e.duration),"2"),i.ct=e.cityTime||"по вашему времени";var n=t;for(var r in i)i.hasOwnProperty(r)&&(n=n.replace("{"+r+"}",i[r]));return n=(n=n.replace("(","<span>")).replace(")","</span>")};!function(win,doc){var loadedTime=(new Date).getTime(),loadedLocalTime=loadedTime,APIState=0,timers=[],setDataAll=function(){for(var t=0;t<timers.length;t++)timers[t].setData()},http=new XMLHttpRequest;http.onreadystatechange=function(){if(4===http.readyState&&200===http.status){var t=http.responseText;try{var e=JSON.parse(t);e.time?(loadedTime=1e3*e.time,loadedLocalTime=(new Date).getTime(),APIState=1,assignToObject(timezones,e.timezones),assignToObject(offsetMaps,e.offsetMaps)):APIState=-1}catch(t){APIState=-1}setDataAll()}},http.onerror=function(){APIState=-1,setDataAll()},http.open("GET",API_URL,!0),http.send(),setTimeout(function(){0===APIState&&(APIState=-1,setDataAll())},1e3);var Timer=function(){function Timer(t){_classCallCheck(this,Timer),_defineProperty(this,"container",null),_defineProperty(this,"childrenElements",{}),_defineProperty(this,"dataInitialized",!1),_defineProperty(this,"zeroInitialized",!0),this.container=t,this.updateOptions(),this.build(),this.tick(),this.container.setAttribute("data-init","1")}return _createClass(Timer,[{key:"updateOptions",value:function updateOptions(){var starts=this.container.getAttribute("data-starts")||"0 0 0 * * * *",startsValues=starts.split(" ");2===startsValues.length&&(starts="0 0 "+startsValues[1]+" * * "+startsValues[0]+" *");for(var _a5=starts.split("|"),_f5=function(t){return parseCronExpression(t.trim())},_r5=[],_i5=0;_i5<_a5.length;_i5++)_r5.push(_f5(_a5[_i5],_i5,_a5));this.startsSet=_r5;for(var interval=this.container.getAttribute("data-interval")||"86400",_a6=interval.split("|"),_f6=function _f6(s){return eval(s)},_r6=[],_i6=0;_i6<_a6.length;_i6++)_r6.push(_f6(_a6[_i6],_i6,_a6));this.intervalSet=_r6,this.startsSet.length!==this.intervalSet.length&&console.error("Количество стартов и интервалов не совпадает"),this.duration=eval(this.container.getAttribute("data-duration")||0),this.caption1=this.container.getAttribute("data-caption1")||this.container.getAttribute("data-c1")||"",this.caption2=this.container.getAttribute("data-caption2")||this.container.getAttribute("data-c2")||"",this.caption3=this.container.getAttribute("data-caption3")||this.container.getAttribute("data-c3")||"",this.offset=this.container.getAttribute("data-offset")||0;var days=this.container.getAttribute("data-days")||"yes";this.showDays="yes"===days||"true"===days||"1"===days;var reload=this.container.getAttribute("data-reload")||!1;this.reload="yes"===reload||"true"===reload||"1"===reload;var targetOffset=this.container.getAttribute("data-target-offset")||"auto";this.targetOffset="auto"===targetOffset?getTimezoneOffset():parseInt(targetOffset,10),this.redirect=this.container.getAttribute("data-redirect")}},{key:"build",value:function(){var r=this,t=function(t,e,i){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",n=newElement(r.childrenElements[t]||r.container,Timer.className+"_"+i);return(r.childrenElements[e]=n).innerHTML=a,n};t(null,"c0","c0"),t("c0","c1","c1",this.caption1?"...":""),t("c0","c2","c2",this.caption2?"...":""),t("c0","c3","c3",this.caption3?"...":""),t(null,"b0","b0");for(var e=0;e<=3;e++){var i=t("b0","b1_"+e,"b1");this.showDays||0!==e||(i.style.display="none"),t("b1_"+e,"b2_"+e,"b2"),t("b1_"+e,"label_"+e,"b3"),t("b2_"+e,"d_"+e+"_1","b4"),t("b2_"+e,"d_"+e+"_2","b4")}}},{key:"setData",value:function(){var t=0;if("auto"===this.offset)t=getTimezoneOffset();else if(offsetMaps[this.offset]){var e=getOffsetFromMap(this.offset,getTimezoneOffset());!1===e?console.error("Смещение по карте не найдено"):t=e}else t=parseInt(this.offset)||0;for(var i,a,n,r=!1,s=0,o=this.startsSet,l=0;l<o.length;l++)i=o[l],a=l,void 0,((n=cronLastRun(i,loadedTime-60*t*1e3))<r||!1===r)&&(r=n,s=a);this.interval=this.intervalSet[s],r=!1===r?(console.error("Время запуска таймера ещё не наступило!"),this.interval):Math.floor(r/1e3),this.timeLeft=this.interval-r;var f={date:new Date(loadedTime+1e3*this.timeLeft+60*(getTimezoneOffset()-this.targetOffset)*1e3),duration:this.duration,cityTime:getCityTime()};this.childrenElements.c1.innerHTML=formatText(this.caption1,f),this.childrenElements.c2.innerHTML=formatText(this.caption2,f),this.childrenElements.c3.innerHTML=formatText(this.caption3,f);var c=this.dataInitialized;this.dataInitialized=!0,c||this.update()}},{key:"update",value:function(){var i=this,t=this.dataInitialized?this.timeLeft:0;(t-=Math.floor(((new Date).getTime()-loadedLocalTime)/1e3))<0&&(t=0);var e=t,a=Math.floor(e/86400);e-=86400*a;var n=Math.floor(e/3600);e-=3600*n;var r=Math.floor(e/60),s=e-=60*r,o=this.dataInitialized?declOfNum(a,["день","дня","дней"]):"...",l=this.dataInitialized?declOfNum(n,["час","часа","часов"]):"...",f=this.dataInitialized?declOfNum(r,["минута","минуты","минут"]):"...",c=this.dataInitialized?declOfNum(s,["секунда","секунды","секунд"]):"...";a=("0"+a).substr(-2),n=("0"+n).substr(-2),r=("0"+r).substr(-2),s=("0"+s).substr(-2);var u=function(t,e){i.childrenElements[t].innerHTML=i.dataInitialized?e:""};return u("d_0_1",a[0]),u("d_0_2",a[1]),u("d_1_1",n[0]),u("d_1_2",n[1]),u("d_2_1",r[0]),u("d_2_2",r[1]),u("d_3_1",s[0]),u("d_3_2",s[1]),u("label_0",o),u("label_1",l),u("label_2",f),u("label_3",c),0<t&&0!==APIState&&(this.zeroInitialized=!1),t}},{key:"tick",value:function(){var t=this;0<this.update()||!1===this.dataInitialized||0===APIState?setTimeout(function(){t.tick()},500):(this.reload||this.redirect)&&!1===this.zeroInitialized&&(this.reload?location.reload():location.href=this.redirect)}}]),Timer}();_defineProperty(Timer,"className","__abm_timer");var initAllTimers=function(){for(var t=doc.querySelectorAll("."+Timer.className),e=0;e<t.length;e++){t[e].getAttribute("data-init")||timers.push(new Timer(t[e]))}0!==APIState&&setDataAll()};initAllTimers(),win.abmTimerInitAll=initAllTimers}(window,document);})();</script>
